(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[625],{1489:e=>{"use strict";e.exports=JSON.parse('[{"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"type":"function"}]')},4493:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var a=n(7876),i=n(4232),s=n(1819),p=n(8554),u=n(5658),r=n(8009),y=n(2090),l=n(3341),o=n(9206);let d=["function quoteExactInputSingle(address tokenIn, address tokenOut, uint24 fee, uint256 amountIn, uint160 sqrtPriceLimitX96) external returns (uint256 amountOut, uint160 sqrtPriceX96After, uint32 initializedTicksCrossed, uint256 gasEstimate)"];async function m(e,t,n,a,i){let s=new y.NZ(o.Gy,d,e),p=l.XS(a,t.decimals),{amountOut:u}=await s.quoteExactInputSingle(t.address,n.address,i,p,0);return l.Js(u,n.decimals)}var c=n(1489);async function T(e,t,n,a){let i=await e.getSigner(),s=new y.NZ(t,c,i),p=await s.decimals(),u=l.XS(a,p);return(await s.approve(n,u)).wait()}let f=JSON.parse('[{"inputs":[{"internalType":"address","name":"_factory","type":"address"},{"internalType":"address","name":"_WETH9","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"WETH9","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"bytes","name":"path","type":"bytes"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"amountOutMinimum","type":"uint256"}],"internalType":"struct ISwapRouter.ExactInputParams","name":"params","type":"tuple"}],"name":"exactInput","outputs":[{"internalType":"uint256","name":"amountOut","type":"uint256"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"address","name":"tokenIn","type":"address"},{"internalType":"address","name":"tokenOut","type":"address"},{"internalType":"uint24","name":"fee","type":"uint24"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"amountOutMinimum","type":"uint256"},{"internalType":"uint160","name":"sqrtPriceLimitX96","type":"uint160"}],"internalType":"struct ISwapRouter.ExactInputSingleParams","name":"params","type":"tuple"}],"name":"exactInputSingle","outputs":[{"internalType":"uint256","name":"amountOut","type":"uint256"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"bytes","name":"path","type":"bytes"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"uint256","name":"amountOut","type":"uint256"},{"internalType":"uint256","name":"amountInMaximum","type":"uint256"}],"internalType":"struct ISwapRouter.ExactOutputParams","name":"params","type":"tuple"}],"name":"exactOutput","outputs":[{"internalType":"uint256","name":"amountIn","type":"uint256"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"address","name":"tokenIn","type":"address"},{"internalType":"address","name":"tokenOut","type":"address"},{"internalType":"uint24","name":"fee","type":"uint24"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"uint256","name":"amountOut","type":"uint256"},{"internalType":"uint256","name":"amountInMaximum","type":"uint256"},{"internalType":"uint160","name":"sqrtPriceLimitX96","type":"uint160"}],"internalType":"struct ISwapRouter.ExactOutputSingleParams","name":"params","type":"tuple"}],"name":"exactOutputSingle","outputs":[{"internalType":"uint256","name":"amountIn","type":"uint256"}],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"factory","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes[]","name":"data","type":"bytes[]"}],"name":"multicall","outputs":[{"internalType":"bytes[]","name":"results","type":"bytes[]"}],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"refundETH","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"name":"selfPermit","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"uint256","name":"expiry","type":"uint256"},{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"name":"selfPermitAllowed","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"uint256","name":"expiry","type":"uint256"},{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"name":"selfPermitAllowedIfNecessary","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"name":"selfPermitIfNecessary","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amountMinimum","type":"uint256"},{"internalType":"address","name":"recipient","type":"address"}],"name":"sweepToken","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amountMinimum","type":"uint256"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"feeBips","type":"uint256"},{"internalType":"address","name":"feeRecipient","type":"address"}],"name":"sweepTokenWithFee","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"int256","name":"amount0Delta","type":"int256"},{"internalType":"int256","name":"amount1Delta","type":"int256"},{"internalType":"bytes","name":"_data","type":"bytes"}],"name":"uniswapV3SwapCallback","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amountMinimum","type":"uint256"},{"internalType":"address","name":"recipient","type":"address"}],"name":"unwrapWETH9","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amountMinimum","type":"uint256"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"feeBips","type":"uint256"},{"internalType":"address","name":"feeRecipient","type":"address"}],"name":"unwrapWETH9WithFee","outputs":[],"stateMutability":"payable","type":"function"},{"stateMutability":"payable","type":"receive"}]');async function b(e,t,n,a,i){var s,p;let u=new y.NZ(o.bp,f,e),r=await (null==(s=e.provider)?void 0:s.getBlock("latest")),d=null!=(p=null==r?void 0:r.timestamp)?p:Math.floor(Date.now()/1e3),m={tokenIn:t.address,tokenOut:n.address,fee:i,recipient:await e.getAddress(),deadline:d+600,amountIn:l.XS(a,t.decimals),amountOutMinimum:0,sqrtPriceLimitX96:0};return(await u.exactInputSingle(m)).wait()}var h=n(1133),x=n(340);function w(){let{tokens:e,addToken:t}=(0,p.c)(),{pools:n,addPool:y}=(0,u.T)(),{poolFee:l}=(0,h.A)(),{provider:d,signer:c,account:f,connectWallet:w}=(0,x.v)(),[v,g]=(0,i.useState)(e[0]),[k,E]=(0,i.useState)(e[1]),[S,j]=(0,i.useState)(""),[M,I]=(0,i.useState)(""),C=(0,i.useRef)(new Set),[O,P]=(0,i.useState)(""),[_,A]=(0,i.useState)([]),[N,F]=(0,i.useState)(!1);(0,i.useEffect)(()=>{e.length>0&&g(e[0]),e.length>1&&E(e[1])},[e]),(0,i.useEffect)(()=>{w()},[]),(0,i.useEffect)(()=>{(async()=>{if(d)for(let n of e){let a=n.address.toLowerCase();if(!C.current.has(a)){C.current.add(a);try{for(let n of(await (0,r.E)(d,a,e)))e.some(e=>e.address.toLowerCase()===n.token.address.toLowerCase())||t(n.token),y({token0:a,token1:n.token.address,fee:n.fee,pool:n.pool})}catch(e){}}}})()},[d,e]);let R=async()=>{d&&S&&await T(d,v.address,o.bp,S)},X=async()=>{c&&S&&await b(c,v,k,S,l)},L=async t=>{if(t.preventDefault(),d){if(!s.PW(O))return void A([]);F(!0);try{let t=await (0,r.E)(d,O,e);A(t),t.forEach(e=>{y({token0:O,token1:e.token.address,fee:e.fee,pool:e.pool})})}catch(e){A([])}finally{F(!1)}}};return(0,i.useEffect)(()=>{(async()=>{if(d&&S&&v&&k)try{let e=await m(d,v,k,S,l);I(e)}catch(e){I("failed")}})()},[S,v,k,d,l]),(0,a.jsxs)("main",{style:{padding:20},children:[(0,a.jsx)("h1",{children:"Cypherium DEX"}),(0,a.jsxs)("div",{children:["Connected: ",f?"".concat(f.slice(0,6),"...").concat(f.slice(-4)):"未接続"]}),(0,a.jsxs)("div",{style:{marginTop:30},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"From:"}),(0,a.jsx)("select",{value:v.symbol,onChange:t=>{let n=e.find(e=>e.symbol===t.target.value);n&&g(n)},children:e.map(e=>(0,a.jsx)("option",{value:e.symbol,children:e.symbol},e.symbol))}),(0,a.jsx)("input",{type:"number",value:S,onChange:e=>j(e.target.value),placeholder:"Amount"})]}),(0,a.jsxs)("div",{style:{marginTop:10},children:[(0,a.jsx)("label",{children:"To:"}),(0,a.jsx)("select",{value:k.symbol,onChange:t=>{let n=e.find(e=>e.symbol===t.target.value);n&&E(n)},children:e.map(e=>(0,a.jsx)("option",{value:e.symbol,children:e.symbol},e.symbol))})]}),(0,a.jsxs)("div",{style:{marginTop:10},children:[(0,a.jsx)("label",{children:"Expected Output:"}),(0,a.jsx)("div",{children:M?"".concat(M," ").concat(k.symbol):"-"})]}),(0,a.jsx)("button",{style:{marginTop:20},onClick:R,children:"Approve"}),(0,a.jsx)("button",{style:{marginTop:10},onClick:X,children:"Swap"}),(0,a.jsxs)("div",{style:{marginTop:30},children:[(0,a.jsx)("h2",{children:"Find Pools"}),(0,a.jsxs)("form",{onSubmit:L,style:{marginBottom:10},children:[(0,a.jsx)("input",{type:"text",placeholder:"ERC20 address",value:O,onChange:e=>P(e.target.value),style:{marginRight:10}}),(0,a.jsx)("button",{type:"submit",children:"Search"})]}),N&&(0,a.jsx)("p",{children:"Searching..."}),_.length>0?(0,a.jsx)("ul",{children:_.map((e,t)=>(0,a.jsxs)("li",{children:[O," / ",e.token.symbol," (fee ",e.fee,") - ",e.pool]},t))}):!N&&O&&(0,a.jsx)("p",{children:"No pools found"})]}),n.length>0&&(0,a.jsxs)("div",{style:{marginTop:30},children:[(0,a.jsx)("h2",{children:"Known Pools"}),(0,a.jsx)("ul",{children:n.map((e,t)=>(0,a.jsxs)("li",{children:[e.token0,"/",e.token1," (fee ",e.fee,") - ",e.pool]},t))})]})]})]})}},6562:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/swap",function(){return n(4493)}])},8009:(e,t,n)=>{"use strict";n.d(t,{E:()=>u});var a=n(2090),i=n(2439),s=n(9206);let p=["function getPool(address tokenA, address tokenB, uint24 fee) external view returns (address)"];async function u(e,t,n){if(!s.Mo)throw Error("UNISWAP_V3_FACTORY_ADDRESS is not set");let u=new a.NZ(s.Mo,p,e),r=[500,3e3,1e4],y=[];for(let e of n)if(e.address.toLowerCase()!==t.toLowerCase())for(let n of r){let a=await u.getPool(t,e.address,n);a&&a!==i.j&&y.push({token:e,fee:n,pool:a})}return y}},9206:(e,t,n)=>{"use strict";n.d(t,{Gy:()=>s,Mo:()=>a,bF:()=>p,bp:()=>i});let a="0x84a4Ef6C41f3Ab726c3A2550d284E37b45FC25D0",i="0xaAB7A983Fc7EcA2fb601cCA7489E11d3945c6301",s="0xf7Edc0095eadb64F92d493a2a2d575f7B8b0810f",p="0x08157C8532CF753FE63C5403515cBa8f1235189A"}},e=>{var t=t=>e(e.s=t);e.O(0,[341,636,593,792],()=>t(6562)),_N_E=e.O()}]);